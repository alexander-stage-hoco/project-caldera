{
  "schema_version": "1.1",
  "scenario": "python",
  "description": "Ground truth for Python smell and security vulnerability detection",
  "generated_at": "2026-02-04T00:00:00Z",
  "repo_path": "eval-repos/synthetic/python",
  "configuration": {
    "base_rulesets": ["DD custom rules"],
    "multi_lang_rulesets": ["p/python"],
    "elttam_rulesets": ["elttam/rules-audit"],
    "notes": "Expected detections vary based on enabled rulesets"
  },
  "expected": {
    "language": "python",
    "version": "3.0",
    "summary": {
      "total_files": 12,
      "total_expected_smells": 40,
      "notes": "Counts reconciled with actual line numbers. Multi-lang adds security detections.",
      "smell_categories_covered": [
        "error_handling",
        "api_design",
        "resource_management",
        "security",
        "correctness",
        "best_practice",
        "performance",
        "entrypoint_discovery"
      ],
      "multi_lang_categories": [
        "COMMAND_INJECTION",
        "UNSAFE_DESERIALIZATION",
        "INSECURE_CRYPTO",
        "SECURITY_MISCONFIGURATION",
        "PATH_TRAVERSAL"
      ],
      "elttam_categories": [
        "ENTRYPOINT_DISCOVERY",
        "AUDIT_INPUT_SINK",
        "AUDIT_FILE_UPLOAD"
      ]
    }
  },
  "files": {
    "empty_catch.py": {
      "expected_smells": [
        {
          "smell_id": "D1_EMPTY_CATCH",
          "count": 3,
          "lines": [
            11,
            22,
            37
          ]
        }
      ],
      "total_expected": 3
    },
    "catch_all.py": {
      "expected_smells": [
        {
          "smell_id": "D2_CATCH_ALL",
          "count": 1,
          "lines": [
            13
          ]
        }
      ],
      "total_expected": 1
    },
    "sql_injection.py": {
      "expected_smells": [
        {
          "smell_id": "SQL_INJECTION",
          "count": 5,
          "lines": [
            13,
            22,
            31,
            39,
            47
          ]
        }
      ],
      "total_expected": 5,
      "notes": "Lines indicate where vulnerable query string is constructed (Semgrep semantics), not where executed."
    },
    "complexity.py": {
      "expected_smells": [
        {
          "smell_id": "H2_LONG_PARAM_LIST",
          "count": 2,
          "lines": [
            7,
            120
          ]
        }
      ],
      "total_expected": 2
    },
    "god_class.py": {
      "expected_smells": [
        {
          "smell_id": "H2_LONG_PARAM_LIST",
          "count": 0,
          "lines": []
        }
      ],
      "total_expected": 0,
      "notes": "God class detection is complex and not reliably detected by Semgrep rules. Marked as 0 expected until specific lines are verified."
    },
    "resource_issues.py": {
      "expected_smells": [
        {
          "smell_id": "F2_MISSING_USING",
          "count": 3,
          "lines": [
            9,
            19,
            27
          ]
        }
      ],
      "total_expected": 3,
      "notes": "Count reconciled with actual line numbers listed."
    },
    "no_smells.py": {
      "expected_smells": [],
      "total_expected": 0
    },
    "correctness_issues.py": {
      "expected_smells": [
        {
          "smell_id": "CORRECTNESS_ISSUE",
          "count": 4,
          "lines": [
            12,
            19,
            26,
            34
          ]
        }
      ],
      "total_expected": 4,
      "notes": "Semgrep detects mutable defaults and comparison issues with +2 line offset"
    },
    "best_practices.py": {
      "expected_smells": [
        {
          "smell_id": "UNSAFE_DESERIALIZATION",
          "count": 1,
          "lines": [
            51
          ]
        }
      ],
      "total_expected": 1,
      "notes": "Semgrep detects pickle.loads as unsafe deserialization. Other patterns (os.popen, bare except, eval, exec) detected by community rules but not mapped to DD smell IDs."
    },
    "performance_issues.py": {
      "expected_smells": [
        {
          "smell_id": "F4_EXCESSIVE_ALLOCATION",
          "count": 3,
          "lines": [
            14,
            23,
            51
          ]
        }
      ],
      "total_expected": 3,
      "notes": "Semgrep detects string concat in loop and list operations as excessive allocation patterns"
    },
    "command_injection.py": {
      "requires_ruleset": "SEMGREP_USE_MULTI_LANG",
      "expected_smells": [
        {
          "smell_id": "COMMAND_INJECTION",
          "min_count": 5,
          "lines": [12, 17, 22, 27, 32]
        },
        {
          "smell_id": "UNSAFE_DESERIALIZATION",
          "min_count": 3,
          "lines": [39, 45, 51]
        },
        {
          "smell_id": "INSECURE_CRYPTO",
          "min_count": 4,
          "lines": [57, 62, 72, 77]
        },
        {
          "smell_id": "SECURITY_MISCONFIGURATION",
          "min_count": 2,
          "lines": [84, 92]
        },
        {
          "smell_id": "PATH_TRAVERSAL",
          "min_count": 1,
          "lines": [98]
        }
      ],
      "total_expected": 15,
      "notes": "Requires SEMGREP_USE_MULTI_LANG=1 for p/python ruleset"
    },
    "entrypoint_patterns.py": {
      "requires_ruleset": "SEMGREP_USE_ELTTAM",
      "expected_smells": [
        {
          "smell_id": "ENTRYPOINT_DISCOVERY",
          "min_count": 15,
          "notes": "Flask routes, Django views, FastAPI endpoints"
        },
        {
          "smell_id": "AUDIT_INPUT_SINK",
          "min_count": 1
        },
        {
          "smell_id": "AUDIT_FILE_UPLOAD",
          "min_count": 1
        }
      ],
      "total_expected": 17,
      "notes": "Requires SEMGREP_USE_ELTTAM=1 for Elttam audit rules"
    }
  }
}
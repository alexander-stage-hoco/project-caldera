# Vulnerability Detection Evaluation

You are evaluating the accuracy of Trivy's CVE vulnerability detection capabilities for a due diligence code analysis tool.

## Context

Trivy is a security scanner that detects CVE vulnerabilities in software dependencies. For due diligence purposes, accurate vulnerability detection is critical for:
- Identifying security liabilities in acquisition targets
- Assessing supply chain risk
- Determining remediation costs

## Evidence

The following evidence shows vulnerability detection results across multiple test repositories:

{{ evidence }}

## Evaluation Criteria

Score 1-5 on vulnerability detection accuracy:

1. **Detection Completeness** (40%): Are known vulnerabilities being detected? Are required packages found?
2. **False Positive Rate** (30%): Are results within expected ranges? No spurious detections?
3. **CVE Data Quality** (30%): Are CVE IDs, CVSS scores, and fix versions properly populated?

### Scoring Rubric

- **5 (Excellent)**: All expected vulnerabilities detected, no false positives, complete CVE metadata
- **4 (Good)**: Most vulnerabilities detected, minimal false positives, mostly complete metadata
- **3 (Acceptable)**: Core vulnerabilities detected, some false positives or missing metadata
- **2 (Poor)**: Missing significant vulnerabilities or high false positive rate
- **1 (Failing)**: Unreliable detection, major accuracy issues

## Response Format

Respond with ONLY a JSON object (no markdown code fences):

{
  "score": <1-5>,
  "confidence": <0.0-1.0>,
  "reasoning": "<2-3 sentences explaining the score>",
  "evidence_cited": ["<specific evidence points that informed your score>"],
  "recommendations": ["<actionable improvements if score < 5>"],
  "sub_scores": {
    "detection_completeness": <1-5>,
    "false_positive_rate": <1-5>,
    "cve_data_quality": <1-5>
  }
}

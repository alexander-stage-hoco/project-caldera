// XSS (Cross-Site Scripting) test cases for DevSkim evaluation
// Expected: DevSkim should detect XSS vulnerabilities

using System;
using System.Web;

namespace SecurityTests
{
    public class XssVulnerability
    {
        // VULNERABLE: Direct HTML output (DS137138)
        public string RenderUserContent(string userInput)
        {
            return "<div>" + userInput + "</div>";
            // DevSkim should flag this as potential XSS
        }

        // VULNERABLE: JavaScript injection (DS126188)
        public string RenderScript(string userCallback)
        {
            return $"<script>callback('{userCallback}')</script>";
            // DevSkim should flag this
        }

        // VULNERABLE: HTML attribute injection
        public string RenderImage(string imageUrl)
        {
            return $"<img src=\"{imageUrl}\" onerror=\"alert('xss')\" />";
            // DevSkim should flag this
        }

        // VULNERABLE: innerHTML usage
        public string GetJavaScript(string content)
        {
            return $"document.getElementById('output').innerHTML = '{content}';";
            // DevSkim should flag innerHTML usage
        }

        // VULNERABLE: eval() usage
        public string GenerateEval(string code)
        {
            return $"eval('{code}');";
            // DevSkim should flag eval
        }

        // SAFE: HTML encoded output
        public string RenderUserContentSafe(string userInput)
        {
            string encoded = HttpUtility.HtmlEncode(userInput);
            return "<div>" + encoded + "</div>";
            // This should NOT be flagged
        }

        // SAFE: URL encoded output
        public string RenderLink(string url)
        {
            string encoded = HttpUtility.UrlEncode(url);
            return $"<a href=\"{encoded}\">Link</a>";
            // This should NOT be flagged
        }

        // SAFE: textContent (not innerHTML)
        public string GetSafeJavaScript(string content)
        {
            return $"document.getElementById('output').textContent = '{content}';";
            // This should NOT be flagged
        }
    }
}
